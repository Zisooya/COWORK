<?xml version="1.0" encoding="UTF-8"?>

<!--  
	DTD(Document Type Definition)
	- 작성한 문서가 어떤 문서인지에 대해서 정의해 놓은 것.
	- 하나의 시스템 내에서 사용할 XML 데이터의 구조를 정의하여 유효성을 점검 시 사용하는 태그.
-->

<!-- 마이바티스 문서에서 복사해옴. -->
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

 <mapper namespace="memberDAO">
	<resultMap type="caldto" id="calMap">
		<result property="title" column="cal_title"/>
		<result property="start" column="cal_start_time"/>
		<result property="end" column="cal_end_time"/>
		<result property="allDay" column="cal_allday"/>
	</resultMap>
	
	<!-- *******************지수**********************-->
	<select id="address_deptList" resultType="departmentDto">
		select * from department
	</select> 	
	
	<!-- *******************세건**********************-->
 	<select id="all" resultType="projectsdto">
		select * from projects order by project_start desc
	</select>
	<select id="getMain" resultType="maindto">
		select * from main_project order by main_no
	</select>
	<select id="status" resultType="statusdto">
		select * from projects_status order by status_no
	</select>
	<insert id="insert" parameterType="projectsdto">
		<selectKey keyProperty="project_no" resultType="int" order="BEFORE">
			select max(project_no) from projects
	    </selectKey>
	    insert into projects values(#{project_no}+1,#{project_name},'',#{project_end},'','',#{project_taker},default,#{project_status},#{project_main},'','','','','')
	</insert>
	<select id="cont" parameterType="int" resultType="projectsdto">
		select * from projects where project_no=#{num}
  	</select>
  	<select id="allMem" resultType="memberDTO">
  		select * from member order by dept_no
  	</select>
  	<update id="updateMember1" parameterType="projectsdto">
  		update projects set project_taker = #{project_taker} where project_no=#{project_no}
  	</update>
  	<update id="updateMember2" parameterType="projectsdto">
  		update projects set project_taker2 = #{project_taker2} where project_no=#{project_no}
  	</update>
  	<update id="updateMember3" parameterType="projectsdto">
  		update projects set project_taker3 = #{project_taker3} where project_no=#{project_no}
  	</update>
  	<update id="updateMember4" parameterType="projectsdto">
  		update projects set project_taker4 = #{project_taker4} where project_no=#{project_no}
  	</update>
  	<update id="updateMember5" parameterType="projectsdto">
  		update projects set project_taker5 = #{project_taker5} where project_no=#{project_no}
  	</update>
  	<delete id="deleteProject" parameterType="int">
  		delete from projects where project_no = #{num}
  	</delete>
  	<update id="move" parameterType="projectsdto">
  		update projects set project_status = #{project_status} where project_no=#{project_no}
  	</update>
  	<update id="start" parameterType="projectsdto">
  		update projects set project_start = #{project_start} where project_no=#{project_no}
  	</update>
  	<update id="end" parameterType="projectsdto">
  		update projects set project_end = #{project_end} where project_no=#{project_no}
  	</update>
  	<update id="comment" parameterType="projectsdto">
  		update projects set project_comment = #{project_comment} where project_no=#{project_no}
  	</update>
	<update id="deletetaker1" parameterType="projectsdto">
		update projects set project_taker = '' where project_no=#{project_no}
	</update>
	<update id="deletetaker2" parameterType="projectsdto">
		update projects set project_taker2 = '' where project_no=#{project_no}
	</update>
	<update id="deletetaker3" parameterType="projectsdto">
		update projects set project_taker3 = '' where project_no=#{project_no}
	</update>
	<update id="deletetaker4" parameterType="projectsdto">
		update projects set project_taker4 = '' where project_no=#{project_no}
	</update>
	<update id="deletetaker5" parameterType="projectsdto">
		update projects set project_taker5 = '' where project_no=#{project_no}
	</update>
	<insert id="insertStatus" parameterType="statusdto">
		<selectKey keyProperty="status_no" resultType="int" order="BEFORE">
			select max(status_no) from projects_status
	    </selectKey>
	    insert into projects_status values(#{status_no}+1,#{status_name})
	</insert>
	<select id="SelectStatus_no" parameterType="String" resultType="int">
		select status_no from projects_status where status_name = #{status_name}
	</select>
	
	<!-- **************** hslee **************** -->
	<select id="login" resultType="memberDTO">
		select * from member where mem_id = #{mem_id} and mem_pwd = #{mem_pwd}
	</select>
	<insert id="join" parameterType="memberDTO">
		<selectKey resultType="int" keyProperty="mem_no" order="BEFORE">
			select max(mem_no) from member
		</selectKey>
		insert into member values (#{mem_no} + 1, #{mem_name}, #{mem_id}, #{mem_pwd}, #{mem_position}, #{mem_rank}, #{dept_no}, #{team_no}, #{mem_email}, #{mem_phone}, #{mem_image})
	</insert>
	<select id="checkId" parameterType="String" resultType="Integer">
		select count(*) from member where mem_id = #{mem_id}
	</select>
 </mapper> 