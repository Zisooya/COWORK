<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="messengerDao">

	<select id="oneToOneChatRoomList" parameterType="int" resultType="chatRoomDto">
		select r.chat_room_no, r.chat_room_name
		from chat_room r join chat_member m
		on r.chat_room_no = m.chat_room_no
		where m.mem_no = #{mem_no} and r.chat_kind in 'one'
	</select>
	
	<select id="groupChatRoomList" parameterType="int" resultType="chatRoomDto">
		select *
		from chat_room r join chat_member m
		on r.chat_room_no = m.chat_room_no
		where m.mem_no = #{mem_no} and r.chat_kind='group'
	</select>
	
	<select id="messageList" parameterType="int" resultType="chatMessageDto">
		select * from chat_message where chat_room_no=#{chat_room_no} order by send_date 
	</select>
	
	<insert id="messenger_insertMessage" parameterType="chatMessageDto">
		insert into chat_message values(#{chat_room_no},#{sender},#{message},TO_DATE(#{send_date},'YYYY-MM-DD HH24:MI:SS'))
	</insert>
</mapper>